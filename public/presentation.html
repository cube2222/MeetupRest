<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>React Tutorial</title>

    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <script src="react/react.js"></script>
    <script src="react/react-dom.js"></script>
    <script src="https://npmcdn.com/babel-core@5.8.38/browser.min.js"></script>
    <script src="https://npmcdn.com/jquery@3.1.0/dist/jquery.min.js"></script>
    <script src="https://npmcdn.com/remarkable@1.6.2/dist/remarkable.min.js"></script>
</head>

<body>
<div id="content"></div>
<script type="text/babel">

  var PresentationList = React.createClass({


    getInitialState: function() {
      return {data: {}}
    },

    componentDidMount: function() {
      $.ajax({
        url: '/presentation/' + getParameterByName("key") + '/',
        dataType: 'json',
        cache: false,
        success: function(data) {
          this.setState({data: data});
        }.bind(this),
        error: function(xhr, status, err) {
          console.error(this.props.url, status, err.toString());
        }.bind(this)
      });
    },

    render: function() {
      return (
        <div className="container theme-showcase">
            <h1>{this.state.data.Title}</h1>
            <h2>{this.state.data.Speaker}</h2>
            <h4>Votes: {this.state.data.Votes} <a href={"/presentation/" + this.state.data.Key + "/upvote"} className="btn btn-success" role="button">Upvote</a></h4>
            <div className="well">{this.state.data.Description}</div>
        </div>
      );
    }
  });

ReactDOM.render(
  <PresentationList/>,
  document.getElementById('content')
);

function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}
    </script>
</body>

</html>